"use strict";function parallax(e,t){for(var r=(window.pageYOffset||document.documentElement.scrollTop)/t,o=0;o<e.length;o++)e[o].style.backgroundPosition="center "+r+"vh"}function getPosition(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=elmYPosition(e[r]);return t}function _readOnlyError(e){throw new Error('"'+e+'" is read-only')}function currentYPosition(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function elmYPosition(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=e.offsetTop-t,o=e;o.offsetParent&&o.offsetParent!=document.body;)_readOnlyError("node"),r+=(o=o.offsetParent).offsetTop;return r}function elmXPosition(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=e.offsetLeft-t,o=e;o.offsetParent&&o.offsetParent!=document.body;)_readOnlyError("node"),r+=(o=o.offsetParent).offsetLeft;return r}function smoothScroll(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=currentYPosition(),n=elmYPosition(e,r),a=o<n?n-o:o-n;if(a<100)scrollTo(0,n);else{20<=(t=Math.round(a/t))&&(t=20);var l=Math.round(a/25),c=o<n?o+l:o-l,i=0;if(o<n)for(var s=o;s<n;s+=l)setTimeout("window.scrollTo(0, "+c+")",i*t),n<(c+=l)&&(c=n),i++;else for(var u=o;n<u;u-=l)setTimeout("window.scrollTo(0, "+c+")",i*t),(c-=l)<n&&(c=n),i++}}function fadeOut(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:40,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},n=4<arguments.length?arguments[4]:void 0,a=1,l=setInterval(function(){a<=.1&&(o(n),t&&e.classList.remove(t),clearInterval(l)),e.style.opacity=a,e.style.filter="alpha(opacity="+100*a+")",a-=.1},r)}function fadeIn(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:40,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},n=4<arguments.length?arguments[4]:void 0,a=.01,l=setInterval(function(){1<=a&&(o(n),t&&e.classList.add(t),clearInterval(l)),e.style.opacity=a,e.style.filter="alpha(opacity="+100*a+")",a+=.1},r)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}window.onload=(function(A){A.MaskedInput=function(e){if(!e||!e.elm||!e.format)return null;if(!(this instanceof A.MaskedInput))return new A.MaskedInput(e);var t=this,n=e.elm,a=e.format,l=e.allowed||"0123456789",c=e.allowedfx||function(){return!0},i=e.separator||"/:-",s=e.typeon||"_YMDhms",u=e.onbadkey||function(){},r=e.onfilled||function(){},o=e.badkeywait||0,d=!e.hasOwnProperty("preserve")||!!e.preserve,f=!0,m=!1,v=a,h=window.addEventListener?function(e,t,r,o){e.addEventListener(t,r,void 0!==o&&o)}:window.attachEvent?function(e,t,r){e.attachEvent("on"+t,r)}:function(e,t,r){e["on"+t]=r},y=function(){for(var e=n.value.length-1;0<=e;e--)for(var t=0,r=s.length;t<r;t++)if(n.value[e]===s[t])return!1;return!0},p=function(e){try{return e.focus(),0<=e.selectionStart?e.selectionStart:document.selection?-document.selection.createRange().moveStart("character",-e.value.length):-1}catch(e){return-1}},_=function(e,t){try{if(e.selectionStart)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var r=e.createTextRange();r.move("character",t),r.select()}}catch(e){return!1}return!0},g=function(e){var t="",r=(e=e||window.event).which,o=e.type;if(null==r&&(r=e.keyCode),null==r)return"";switch(r){case 8:t="bksp";break;case 46:t="keydown"===o?"del":".";break;case 16:t="shift";break;case 0:case 9:case 13:t="etc";break;case 37:case 38:case 39:case 40:t=e.shiftKey||39===e.charCode||void 0===e.charCode?String.fromCharCode(r):"etc";break;default:t=String.fromCharCode(r)}return t},b=function(e,t){e.preventDefault&&e.preventDefault(),e.returnValue=t||!1},S=function(e){var t=p(n),r=n.value,o="";switch(!0){case-1!==l.indexOf(e):if((t+=1)>a.length)return!1;for(;-1!==i.indexOf(r.charAt(t-1))&&t<=a.length;)t+=1;if(!c(e,t))return u(e),!1;o=r.substr(0,t-1)+e+r.substr(t),-1===l.indexOf(r.charAt(t))&&-1===s.indexOf(r.charAt(t))&&(t+=1);break;case"bksp"===e:if((t-=1)<0)return!1;for(;-1===l.indexOf(r.charAt(t))&&-1===s.indexOf(r.charAt(t))&&1<t;)t-=1;o=r.substr(0,t)+a.substr(t,1)+r.substr(t+1);break;case"del"===e:if(t>=r.length)return!1;for(;-1!==i.indexOf(r.charAt(t))&&""!==r.charAt(t);)t+=1;o=r.substr(0,t)+a.substr(t,1)+r.substr(t+1),t+=1;break;case"etc"===e:return!0;default:return!1}return n.value="",n.value=o,_(n,t),!1},q=function(e){if(!f)return!0;if(e=e||event,m)return b(e),!1;var t=g(e);return!!("etc"===t||e.metaKey||e.ctrlKey||e.altKey)||"bksp"!==t&&"del"!==t&&"shift"!==t&&(function(e){if(-1!==l.indexOf(e)||"bksp"===e||"del"===e||"etc"===e)return!0;var t=p(n);return m=!0,u(e),setTimeout(function(){m=!1,_(n,t)},o),!1}(t)?S(t)?(y()&&r(),b(e,!0),!0):(y()&&r(),b(e),!1):(b(e),!1))};return t.resetField=function(){n.value=a},t.setAllowed=function(e){l=e,t.resetField()},t.setFormat=function(e){a=e,t.resetField()},t.setSeparator=function(e){i=e,t.resetField()},t.setTypeon=function(e){s=e,t.resetField()},t.setEnabled=function(e){f=e},!n.tagName||"INPUT"!==n.tagName.toUpperCase()&&"TEXTAREA"!==n.tagName.toUpperCase()?null:(d&&""!==n.value||(n.value=a),h(n,"keydown",function(e){!function(e){if(f){if(e=e||event,m)return b(e);var t=g(e);!e.metaKey&&!e.ctrlKey||"X"!==t&&"V"!==t?e.metaKey||e.ctrlKey||(""===n.value&&(n.value=a,_(n,0)),"bksp"!==t&&"del"!==t||(S(t),b(e))):b(e)}}(e)}),h(n,"keypress",function(e){q(e)}),h(n,"focus",function(){v=n.value}),h(n,"blur",function(){n.value!==v&&n.onchange&&n.onchange()}),t)}}(window),void MaskedInput({elm:document.getElementById("phone"),format:"+380 (__) ___-__-__",separator:"+380 ()-"})),window.onload=function(){var e=document.querySelector(".main-header--mobile"),t=document.querySelector(".main-header--list"),a=document.querySelectorAll('[data-parallax="true"]'),r=document.querySelectorAll('[data-smooth="true"]'),l=document.querySelectorAll('[data-toggle-main="true"]'),c=document.querySelectorAll('[data-toggle-alt="true"]'),o=document.querySelectorAll('[data-anchor-main="true"]'),n=document.querySelectorAll('[data-anchor-shop="true"]'),i=document.querySelector(".alt-nav"),s=document.querySelector("#shop"),u=(document.querySelectorAll(".product"),document.querySelectorAll(".product--more-info")),d=(document.querySelectorAll(".product--details"),document.querySelectorAll(".product--details"),document.querySelectorAll(".product--buy")),f=document.querySelectorAll(".product--color"),m=document.querySelectorAll(".product--picture"),v=document.querySelectorAll(".details--picture"),h=document.querySelector(".orders"),y=document.querySelector("#orders--form"),q=document.querySelector(".orders--list"),p=document.querySelectorAll(".orders--input__required"),_=document.querySelector(".main-header--orders"),A=document.querySelector(".main-header--amount"),w=document.querySelector(".main-header--buy"),g=document.querySelector(".orders--close"),x=document.querySelector(".price--amount"),b=document.querySelector("#cod"),S=document.querySelector(".orders--label__cod"),L=document.querySelector(".orders--overlay"),k=(document.querySelector(".order--deletes"),document.querySelector(".orders--submit"),document.querySelector(".orders--empty")),E=document.querySelector(".orders--error"),C=document.querySelector("#name"),T=document.querySelector("#surname"),O=document.querySelector("#phone"),P=(document.querySelectorAll(".modal"),document.querySelectorAll(".overlay")),D=document.querySelectorAll(".modal--btn"),I=document.querySelector(".thanks-for-order"),M=document.querySelector(".thanks-for-order--btn"),Y=document.querySelector(".thanks-for-order--overlay");e.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("main-header--list__show"),t.classList.toggle("main-header--list__hide")});var R,H,K=(R=s,(H=new Object).topPos=R.offsetTop,H.botPos=s.offsetHeight+s.offsetTop,H),N=getPosition(o),j=getPosition(n);998<window.innerWidth&&"undefined"==typeof InstallTrigger&&(window.onscroll=function(){parallax(a,10);for(var e=window.pageYOffset||document.documentElement.scrollTop,t=0;t<l.length;t++)l[t].closest(".main-header--item").classList.remove("main-header--item__active");for(var r=0;r<N.length;r++)if(e>=N[r]-200&&e<N[r+1]-200?l[r].closest(".main-header--item").classList.add("main-header--item__active"):e>=N[N.length-1]-200&&l[N.length-1].closest(".main-header--item").classList.add("main-header--item__active"),e>=K.topPos-200&&e<K.botPos-400){i.classList.add("alt-nav__visible");for(var o=0;o<c.length;o++)c[o].classList.remove("alt-nav--item__active");for(var n=0;n<j.length;n++)e>=j[n]-400&&e<j[n+1]-400?c[n].classList.add("alt-nav--item__active"):e>=j[j.length-1]-400&&c[j.length-1].classList.add("alt-nav--item__active")}else(e<K.topPos-200||e>=K.botPos-400)&&i.classList.remove("alt-nav__visible")});for(var F=0;F<r.length;F++)r[F].addEventListener("click",function(e){e.preventDefault(),smoothScroll(document.querySelector(this.getAttribute("href")),10,60)});for(var X=0;X<f.length;X++)f[X].addEventListener("click",function(e){e.preventDefault();for(var t=_toConsumableArray(f).indexOf(this),r=m[t].closest(".product--more-info__img").querySelectorAll(".product--picture__active"),o=f[t].closest(".product--colors").querySelectorAll(".product--color__active"),n=0;n<o.length;n++)o[n].classList.remove("product--color__active");if(f[t].classList.add("product--color__active"),!(1<m[t].closest(".product--more-info__img").querySelectorAll(".product--picture").length))return!1;for(var a=0;a<r.length;a++)fadeOut(r[a],"product--picture__active");fadeIn(m[t],"product--picture__active")});for(var W=0;W<u.length;W++)u[W].addEventListener("click",function(e){var t=this.getAttribute("href"),r=document.querySelector(t),o=r.previousElementSibling,n=this.closest(".product").querySelector(".product--picture__active"),a=_toConsumableArray(m).indexOf(n);B([r,o],["modal__show","overlay__show"],[r,o],["modal__hide","overlay__hide"]),r.querySelector('[tabindex="-1"]').setAttribute("tabindex","1");for(var l=0;l<v.length;l++)v[l].classList.remove("details--picture__active");v[a].classList.add("details--picture__active")});for(var U=0;U<P.length;U++)P[U].addEventListener("click",function(e){e.preventDefault();var t=this.nextElementSibling;if(!t.classList.contains("modal"))return!1;B([t,this],["modal__hide","overlay__hide"],[t,this],["modal__show","overlay__show"]),t.querySelector('[tabindex="1"]').setAttribute("tabindex","-1")});for(var $=0;$<D.length;$++)D[$].addEventListener("click",function(e){e.preventDefault();var t=this.closest(".modal"),r=t.previousElementSibling;t&&B([t,r],["modal__hide","overlay__hide"],[t,r],["modal__show","overlay__show"]),t.querySelector('[tabindex="1"]').setAttribute("tabindex","-1")});for(var V=0;V<d.length;V++)d[V].addEventListener("click",function(e){e.preventDefault();var r=this.closest(".shop--item").querySelector(".product--about").textContent,o=this.closest(".shop--item").querySelector(".product--price").textContent.replace(/\D+/g,""),t=this.closest(".shop--item").querySelector(".product--picture__active"),n=t.querySelector("source").srcset,a=t.querySelector("source").type,l=(t.querySelector(".product--img"),t.querySelector(".product--img").getAttribute("src")),c=t.querySelector(".product--img").getAttribute("alt"),i=this.closest(".shop--item").querySelector(".product--more-info").getAttribute("href"),s=i.replace(/\D+/g,""),u=this.closest(".shop--item").querySelector(".product--color__active").textContent,d=document.querySelectorAll(".order"),f=new Array,m=new Array,v=new Array,h=new Array;if(k.hidden=!0,w.classList.add("main-header--buy__rotate"),d.length){for(var y=0;y<d.length;y++)f[y]=d[y].querySelector(".order--name").textContent,m[y]=d[y].querySelector(".order--price").textContent.replace(/\D+/g,""),v[y]=d[y].querySelector(".order--picture__active").querySelector(".order--img").getAttribute("src"),h[y]=d[y].querySelector(".order--amount").getAttribute("value");z(!0,!0,!0,0);var p=f.indexOf(r),_=m.indexOf(o),g=v.indexOf(l);if(-1!==p&&-1!==_&&-1!==g){var b=+d[p].querySelector(".order--amount").value;b++,d[p].querySelector(".order--amount").setAttribute("value",b),z(!0,!0,!1,0)}else S(),z(!0,!0,!1,0)}else S(),x.textContent=o,setTimeout(function(){A.textContent=1},500);function S(){var e=' <a class="order--more-info" href="'.concat(i,'" data-number="').concat(s,'"> \n        <picture class="order--picture order--picture__active">\n        <source srcset="').concat(n,'" type="').concat(a,'"/>\n        <img class="order--img" src="').concat(l,'" alt="').concat(c,'" data-color="').concat(u,'">\n        </picture> \n        </a>\n        <div class="order--info">\n        <p class="order--name">').concat(r,'</p>\n        <label class="order--label">\n        Количество:\n        <input type="number" min="1" max="10" class="order--amount" value="1">\n        </label>\n        <p class="order--price">').concat(o,' <span class="orders--currency">грн.</span></p>\n        <button class="order--delete">Удалить товар</button>\n        </div>'),t=document.createElement("li");t.className+=" orders--item order",t.innerHTML=e,q.appendChild(t)}});function B(e,t,r,o){for(var n=0;n<e.length;n++)e[n].classList.add(t[n]);for(var a=0;a<r.length;a++)r[a].classList.remove(o[a])}function J(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function z(e,t,r){for(var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,n=document.querySelectorAll(".order"),a=new Array,l=new Array,c=0;c<n.length;c++)a[c]=n[c].querySelector(".order--amount").getAttribute("value"),l[c]=n[c].querySelector(".order--price").textContent.replace(/\D+/g,"");if(e&&t){for(var i=0,s=0,u=0;u<a.length;u++)i+=+a[u];r&&i++,setTimeout(function(){A.textContent=i.toString()},500);for(var d=0;d<l.length;d++)s+=l[d]*a[d];x.textContent=(s-s/100*o).toString()}}w.addEventListener("webkitAnimationEnd",function(e){w.classList.remove("main-header--buy__rotate")}),w.addEventListener("animationend",function(e){w.classList.remove("main-header--buy__rotate")}),document.addEventListener("input",function(e){e.target&&"order--amount"==e.target.classList[0]&&(e.target.setAttribute("value",e.target.value),z(!0,!0,!1,0))}),_.addEventListener("click",function(e){e.preventDefault();var t=h.querySelectorAll('[tabindex="-1"]');B([h,L],["orders__show","overlay__show"],[h,L,g],["orders__hide","overlay__hide","orders--close__rotate"]);for(var r=0;r<t.length;r++)t[r].setAttribute("tabindex","1");998<window.innerWidth&&b.focus()}),g.addEventListener("click",function(e){e.preventDefault();var t=h.querySelectorAll('[tabindex="1"]');B([g,h,L],["orders--close__rotate","orders__hide","overlay__hide"],[h,L],["orders__show","overlay__show"]);for(var r=0;r<t.length;r++)t[r].setAttribute("tabindex","-1")}),L.addEventListener("click",function(e){e.preventDefault();var t=h.querySelectorAll('[tabindex="1"]');B([g,h,L],["orders--close__rotate","orders__hide","overlay__hide"],[h,L],["orders__show","overlay__show"]);for(var r=0;r<t.length;r++)t[r].setAttribute("tabindex","-1")}),b.addEventListener("input",function(r){var o,e,t,n;r.preventDefault(),e=function(e){o=e;for(var t=0;t<o.length;t++)if(r.target.closest(".orders--label__cod").classList.remove("orders--label__descending"),z(!0,!0,!1,0),r.target.value==o[t]){r.target.closest(".orders--label__cod").classList.add("orders--label__descending"),z(!0,!0,!1,10);break}},t=new XMLHttpRequest,n=new Array,t.open("POST","../php/promocods.php"),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=function(){if("4"==t.readyState&&200==t.status)n=t.responseText.replace(/\n/gi,"").split(","),e(n);else if("4"==t.readyState&&200!==t.status)return!1},t.send()}),document.addEventListener("click",function(e){if(e.target&&"order--img"==e.target.classList[0]){e.preventDefault();e.target.closest(".order");for(var t=e.target.getAttribute("src"),r=e.target.closest(".order--more-info").getAttribute("href"),o=document.querySelector(r),n=o.previousElementSibling,a=new Array,l=0;l<m.length;l++)a.push(m[l].querySelector(".product--img").getAttribute("src"));var c=a.indexOf(t);B([o,n],["modal__show","overlay__show"],[o,n],["modal__hide","overlay__hide"]),o.querySelector('[tabindex="-1"]').setAttribute("tabindex","1");for(var i=0;i<v.length;i++)v[i].classList.remove("details--picture__active");v[c].classList.add("details--picture__active")}}),document.addEventListener("click",function(e){if(e.target&&"order--delete"==e.target.classList[0]){e.preventDefault();var t=e.target.closest(".order");fadeOut(t,"",40,function(e){e.parentNode.removeChild(e),z(!0,!0,!1,0)},t)}}),y.addEventListener("submit",function(e){if(e.preventDefault(),!q.querySelector(".orders--item"))return k.hidden=!1;!function(e){for(var t=0;t<p.length;t++)p[t].value||(E.hidden=!1);C.value.match(/^[а-яФА-Я]+$/)||(E.hidden=!1);T.value.match(/^[а-яФА-Я]+$/)||(E.hidden=!1);O.value.match(/^\+380 \([0-9]{2}\) [0-9]{3}-[0-9]{2}-[0-9]{2}$/)?e():E.hidden=!1}(Q)}),M.addEventListener("click",function(e){e.preventDefault(),J(q),y.reset(),x.textContent="0",A.textContent="0",S.classList.remove("orders--label__descending")}),Y.addEventListener("click",function(e){e.preventDefault(),J(q),y.reset(),x.textContent="0",A.textContent="0",S.classList.remove("orders--label__descending")});for(var G=0;G<p.length;G++)p[G].addEventListener("input",function(e){e.preventDefault(),E.hidden=!0});function Q(){for(var e=document.querySelectorAll(".orders--item"),t=new XMLHttpRequest,r=new Array,o=0;o<e.length;o++)r.push({name:e[o].querySelector(".order--name").textContent,amount:e[o].querySelector(".order--amount").value,price:e[o].querySelector(".order--price").textContent.replace(/\D+/g,""),number:e[o].querySelector("[data-number]").getAttribute("data-number"),color:e[o].querySelector("[data-color]").getAttribute("data-color")});var n=JSON.stringify({name:C.value.toString(),surname:T.value.toString(),phone:O.value.toString(),order:r,promocod:b.value.toString(),"promocod-descending":S.classList.contains("orders--label__descending"),summ:x.textContent});t.open("POST","../php/form.php"),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=function(){if(document.body.classList.add("wait"),"4"==t.readyState&&200==t.status&&"1"==t.responseText)document.body.classList.remove("wait"),B([I,Y],["modal__show","overlay__show"],[I,Y],["modal__hide","overlay__hide"]),I.querySelector('[tabindex="-1"]').setAttribute("tabindex","1");else if("4"==t.readyState&&200==t.status&&"1"!==t.responseText)switch(document.body.classList.remove("wait"),t.responseText){case"err_1":E.textContent="Заполните все поля формы",E.hidden=!1;break;case"err_2_1":E.textContent="Имя некоректно, исправьте ошибку",E.hidden=!1;break;case"err_2_2":E.textContent="Фамилия некоректна, исправьте ошибку",E.hidden=!1;break;case"err_2_3":E.textContent="Номер телефона некоректен, исправьте ошибку",E.hidden=!1}else"4"!=t.readyState&&200===t.status||(document.body.classList.remove("wait"),E.textContent="Ошибка отправки данных, повторите попытку позже",E.hidden=!1)},t.send(n)}};